---
title: "Statistical Learning Final Project"
author: "**Kevin Finn**"
format: html
---

```{r config, include=FALSE}
# Set global configurations and settings here
knitr::opts_chunk$set()                 # set global chunk options
ggplot2::theme_set(ggplot2::theme_bw()) # set ggplot2 theme
```


# Required R packages and Directories

```{r packages, message=FALSE, warning=FALSE}
library(tidyverse) # functions for data manipulation
library(Lahman)
library(dplyr)
```

::: {.callout-note title="Solution"}
```{r}
HallOfFameTotal<-HallOfFame %>%
  filter(votedBy=='BBWAA' & category=='Player' & yearID >= '1950')

UniquePlayers <- unique(HallOfFameTotal$playerID)

UniquePlayersDF <- data.frame("playerID" = UniquePlayers)

HallOfFameYes <- HallOfFame %>%
  filter(votedBy=='BBWAA' & category=='Player' & inducted =='Y' & yearID >= '1950')

HallOfFameYes <- HallOfFameYes[, c("playerID", "inducted")]

merged_players <- merge(UniquePlayersDF, HallOfFameYes, by = "playerID", all = TRUE)

merged_players$inducted <- ifelse(is.na(merged_players$inducted), 'N', merged_players$inducted)

merged_players$HOF <- ifelse(merged_players$inducted== "N",0,1)

merged_players <- merged_players[, c("playerID", "HOF")]
```

```{r}
data("Fielding")
player_data <- subset(Fielding, playerID %in% merged_players$playerID)
player_data <- player_data[, c("playerID", "POS")]
```

```{r}
most_common_position <- player_data %>%
  group_by(playerID) %>%
  summarize(MostCommonPosition = names(which.max(table(POS))))
```

```{r}
merged_players <- left_join(merged_players, most_common_position, by = "playerID")

merged_players <- merged_players %>% rename(POS = MostCommonPosition)

```

```{r}
HOFP <- subset(merged_players, POS == "P")
HOFH <- subset(merged_players, POS != "P")
```



```{r}
BattingSum <- Batting %>%
  group_by(playerID) %>%
  summarise(across(where(is.numeric),sum))
PitchingSum <- Pitching %>%
  group_by(playerID) %>%
  summarise(across(where(is.numeric),sum))
```

```{r}
PitchingSum <- subset(PitchingSum, select = -c(yearID, stint, BAOpp, ERA))
BattingSum <- subset(BattingSum, select = -c(yearID, stint))
```
:::


::: {.callout-note title="Solution"}
```{r}
HOF_hit <- left_join(HOFH, BattingSum, by = "playerID")
HOF_pitch <- left_join(HOFP, PitchingSum, by = "playerID")
```

```{r}
HOF_hit$SF[is.na(HOF_hit$SF)] <- 0
HOF_hit$HBP[is.na(HOF_hit$HBP)] <- 0
HOF_hit$IBB[is.na(HOF_hit$IBB)] <- 0

# Calculate Batting Average (BA)
HOF_hit$BA <- HOF_hit$H / HOF_hit$AB

# Calculate On-Base Percentage (OBP)
HOF_hit$OBP <- (HOF_hit$H + HOF_hit$BB) / (HOF_hit$AB + HOF_hit$BB + HOF_hit$HBP + HOF_hit$SF)

# Calculate Slugging Percentage (SLG)
HOF_hit$SLG <- (HOF_hit$H + HOF_hit$X2B + 2 * HOF_hit$X3B + 3 * HOF_hit$HR) / HOF_hit$AB

HOF_hit$OPS <- HOF_hit$OBP + HOF_hit$SLG

# Print the updated dataframe
print(HOF_hit)

HOF_pitch$WHIP <- (HOF_pitch$H + HOF_pitch$BB + HOF_pitch$HBP)/(HOF_pitch$IPouts/3)

HOF_pitch$ERA <- (HOF_pitch$ER/(HOF_pitch$IPouts/3))*9

HOF_pitch

```



```{r}
HOF_pitch <- subset(HOF_pitch, select = -c(WP, HBP, SH,SF, GIDP, IBB, BK, GF, IPouts, BFP, R))
HOF_hit <- subset(HOF_hit, select = -c(CS, IBB, HBP, SH, SF, GIDP))


```

::: {.callout-note title="Solution"}

:::



::: {.callout-note title="Solution"}

:::



::: {.callout-note title="Solution"}

:::



::: {.callout-note title="Solution"}

:::




::: {.callout-note title="Solution"}
```{r}

```
:::


::: {.callout-note title="Solution"}

:::




::: {.callout-note title="Solution"}

:::

::: {.callout-note title="Solution"}

:::
